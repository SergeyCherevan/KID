---
name: Горизонтальный скролл консоли
overview: Добавить отображение горизонтальной полосы прокрутки в консольном выводе WPF при переполнении строки по ширине, приоритетно без изменений C#-кода. План учитывает текущую архитектуру MVVM/DI и требования по локализации/документации.
todos: []
isProject: false
---

# План реализации горизонтальной прокрутки консоли

## 1. Анализ требований
1. **Описание функции и цель**
   - При длинной строке в консольном блоке должен появляться горизонтальный скролл, чтобы пользователь мог читать строку без переноса.
   - Цель: повысить читаемость выводов компилятора/ошибок/логов с длинными путями и сообщениями.

2. **Целевая аудитория и сценарии**
   - Пользователи IDE, запускающие код и читающие консольный вывод.
   - Ключевой сценарий: вывод строки шире видимой области консоли -> пользователь прокручивает вправо/влево.

3. **Входные и выходные данные**
   - Вход: текст, который пишется в консоль через существующий механизм `TextBoxConsole`.
   - Выход: визуальное поведение `TextBox` в UI (горизонтальный скролл при переполнении).

4. **Ограничения и требования**
   - Предпочтительно только XAML, без изменений C#.
   - Не нарушить текущую логику MVVM/DI и обработку ввода в консоли.
   - Не изменять поведение других `TextBox` в приложении, если это не согласовано.

## 2. Архитектурный анализ
1. **Затронутые подсистемы**
   - Представление консоли: [d:\Visual Studio Projects\KID\KID.WPF.IDE\Views\ConsoleOutputView.xaml](file:///d:/Visual%20Studio%20Projects/KID/KID.WPF.IDE/Views/ConsoleOutputView.xaml)
   - Потенциально стили тем (если будет решено вынести в стиль):
     - [d:\Visual Studio Projects\KID\KID.WPF.IDE\Themes\DarkTheme.xaml](file:///d:/Visual%20Studio%20Projects/KID/KID.WPF.IDE/Themes/DarkTheme.xaml)
     - [d:\Visual Studio Projects\KID\KID.WPF.IDE\Themes\LightTheme.xaml](file:///d:/Visual%20Studio%20Projects/KID/KID.WPF.IDE/Themes/LightTheme.xaml)

2. **Новые компоненты**
   - Новые C#-компоненты не требуются.
   - Опционально: локальный XAML-стиль для консольного `TextBox` (если нужно отделить от глобального `TextBox`-стиля).

3. **Изменяемые компоненты**
   - Основное изменение: `ConsoleOutputControl` в `ConsoleOutputView.xaml`.
   - Возможные свойства для настройки:
     - `HorizontalScrollBarVisibility="Auto"`
     - `TextWrapping="NoWrap"`

4. **Зависимости между компонентами**
   - `ConsoleOutputView.xaml` связан с `IConsoleOutputViewModel`, но для задачи достаточно UI-слоя.
   - Логика вывода в [d:\Visual Studio Projects\KID\KID.WPF.IDE\Services\CodeExecution\TextBoxConsole.cs](file:///d:/Visual%20Studio%20Projects/KID/KID.WPF.IDE/Services/CodeExecution/TextBoxConsole.cs) остаётся без изменений.

## 3. Список задач
1. **Изменение разметки консоли (XAML-only)**
   - Файл: [d:\Visual Studio Projects\KID\KID.WPF.IDE\Views\ConsoleOutputView.xaml](file:///d:/Visual%20Studio%20Projects/KID/KID.WPF.IDE/Views/ConsoleOutputView.xaml)
   - Добавить/уточнить свойства `TextBox`, чтобы горизонтальный скролл показывался при переполнении.

2. **Проверка влияния на темы/стили**
   - Файлы: [d:\Visual Studio Projects\KID\KID.WPF.IDE\Themes\DarkTheme.xaml](file:///d:/Visual%20Studio%20Projects/KID/KID.WPF.IDE/Themes/DarkTheme.xaml), [d:\Visual Studio Projects\KID\KID.WPF.IDE\Themes\LightTheme.xaml](file:///d:/Visual%20Studio%20Projects/KID/KID.WPF.IDE/Themes/LightTheme.xaml)
   - Убедиться, что глобальный `TextBox`-стиль не переопределяет нужное поведение (или явно зафиксировать поведение в `ConsoleOutputView`).

3. **Локализация**
   - Для этой функции новые UI-строки не добавляются.
   - Проверить, что изменений в `.resx` не требуется (формально закрыть пункт локализации).

4. **Документация**
   - Обновить краткое описание поведения консоли в проектной документации (раздел про UI/консоль), если такой раздел есть.
   - Указать, что длинные строки не переносятся и читаются через горизонтальную прокрутку.

5. **Тестирование**
   - Ручной тест в IDE:
     - вывести строку длиннее ширины консоли;
     - проверить появление горизонтального скролла;
     - проверить работу вертикального скролла;
     - проверить, что ввод/чтение через консоль не сломаны.

## 4. Порядок выполнения
1. Подготовка: подтвердить, что целевая область изменений — только `ConsoleOutputView.xaml`.
2. Внести XAML-изменения для `ConsoleOutputControl`.
3. Проверить, что темы не ломают поведение (dark/light).
4. Выполнить ручной сценарий тестирования длинных строк.
5. При необходимости обновить документацию и зафиксировать результат.

## 5. Оценка сложности
1. **Изменение XAML в `ConsoleOutputView.xaml`**
   - Сложность: низкая
   - Время: 10-20 минут
   - Риски: возможное скрытое влияние глобальных стилей/шаблонов `TextBox`.

2. **Проверка тем и стилей**
   - Сложность: низкая
   - Время: 10-15 минут
   - Риски: разное поведение в темах при кастомных template/style.

3. **Ручное тестирование поведения скроллов и ввода**
   - Сложность: низкая-средняя
   - Время: 20-30 минут
   - Риски: авто-скролл к концу (`ScrollToEnd`) может ухудшать UX при чтении старого длинного вывода.

4. **Документация (если есть соответствующий раздел)**
   - Сложность: низкая
   - Время: 10 минут
   - Риски: отсутствует единое место документации по UI-поведению.

## Техническая стратегия (предпочтительная)
- Реализовать через XAML в `ConsoleOutputView` без C#:
  - включить `HorizontalScrollBarVisibility="Auto"`;
  - убедиться, что `TextWrapping="NoWrap"`.
- Это минимально-инвазивно и соответствует требованию «без C#-кода».